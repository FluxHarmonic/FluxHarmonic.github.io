<!doctype html>
<html lang="en-us" data-theme="dark">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      Flux Harmonic
      
    </title>
    
    
    
    
  <meta property="og:title" content="Creating the Graphics Layer">
  <meta property="og:url" content="https://fluxharmonic.com/live-streams/2021-12-30/">
  
  
  <meta name="twitter:card" content="summary_large_image">

    <link rel="stylesheet" href="https://fluxharmonic.com/static/style.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lora&family=Space+Mono&display=swap" />
    <script defer data-domain="fluxharmonic.com" src="https://plausible.io/js/plausible.js"></script>
    
  </head>
  <body>
    
    
      <header>
        <a href="https://fluxharmonic.com/">
          <img class="logo" src="https://fluxharmonic.com/static/Flux-Harmonic-Site-Logo.png" alt="Flux Harmonic"/>
        </a>
        <nav>
          <ul>
            <li><a href="https://fluxharmonic.com/live-streams/index.html">Live Streams</a></li>
            <li><a href="https://fluxharmonic.com/how-to-help/">How To Help</a></li>
            <li><a href="https://youtube.com/FluxHarmonicLive">YouTube</a></li>
            <li><a href="https://github.com/FluxHarmonic">GitHub</a></li>
          </ul>
        </nav>
      </header>
    

    
    <main id="main">
      
  <article class="post">
    <h1 class="post__title">
      Creating the Graphics Layer
    </h1>
    <section class="post__meta">
      
        Dec 30, 2021
      
    </section>
    <section>
      <p>
View the code: <a href="https://github.com/FluxHarmonic/flux-compose">https://github.com/FluxHarmonic/flux-compose</a>
</p>

<div id="outline-container-schedule-change" class="outline-2">
<h2 id="schedule-change">Schedule Change!</h2>
<div class="outline-text-2">
<p>
Starting <b>next week</b> I'm moving the stream start time forward by one hour.
</p>

<p>
Streams will now be <b>Tuesday and Thursday, 2PM - 5PM UTC</b>!
</p>
</div>
</div>

<div id="outline-container-graphics-layer-design" class="outline-2">
<h2 id="graphics-layer-design">Graphics Layer Design</h2>
<div class="outline-text-2">
<p>
Let's continue with the idea we came up with last time to see how far we can take it:
</p>

<ul class="org-ul">
<li>Use a <a href="https://en.wikipedia.org/wiki/Retained_mode">retained mode</a> rendering model</li>
<li>Describe the graphics to be rendered in the Scheme layer</li>
<li>The C layer will interpret and render the complete scene or instruction list efficiently</li>
<li>The Scheme layer can replace the graphics instructions at any time (REPL-based "drawing")</li>
<li>Animations will eventually be possible by describing changes to elements in the scene over time</li>
</ul>

<p>
The goal today is to get some basic things rendering in a preview window and <i>possibly</i> save it out to a .png file.
</p>
</div>
</div>

<div id="outline-container-tasks" class="outline-2">
<h2 id="tasks">Tasks</h2>
<div class="outline-text-2">
<p>
Here's what I'd like to accomplish today:
</p>
</div>

<div id="outline-container-rename-the-project-to-flux-compose" class="outline-3">
<h3 id="rename-the-project-to-flux-compose"><span class="done DONE">DONE</span> Rename the project to <code>flux-compose</code></h3>
<div class="outline-text-3">
</div>
</div>

<div id="outline-container-create-a-shared-library-for-core-c-code" class="outline-3">
<h3 id="create-a-shared-library-for-core-c-code"><span class="done DONE">DONE</span> Create a shared library for core C code</h3>
<div class="outline-text-3">
</div>
</div>
<div id="outline-container-try-a-ffi-approach-for-calling-c-functions-from-a-shared-library" class="outline-3">
<h3 id="try-a-ffi-approach-for-calling-c-functions-from-a-shared-library"><span class="done DONE">DONE</span> Try a FFI approach for calling C functions from a shared library</h3>
<div class="outline-text-3">
</div>
</div>
<div id="outline-container-get-the-screen-clearing" class="outline-3">
<h3 id="get-the-screen-clearing"><span class="done DONE">DONE</span> Get the screen clearing</h3>
<div class="outline-text-3">
</div>
</div>
<div id="outline-container-find-a-faster-way-to-iterate-on-the-native-layer" class="outline-3">
<h3 id="find-a-faster-way-to-iterate-on-the-native-layer"><span class="done DONE">DONE</span> Find a faster way to iterate on the native layer</h3>
<div class="outline-text-3">
</div>
</div>
<div id="outline-container-get-something-simple-rendering-in-the-c-code" class="outline-3">
<h3 id="get-something-simple-rendering-in-the-c-code"><span class="done DONE">DONE</span> Get something simple rendering in the C code</h3>
<div class="outline-text-3">
</div>
</div>
<div id="outline-container-figure-out-why-init-graphics-is-crashing-the-process-can-we-come-up-with-a-good-debugging-strategy-running-via-gdb" class="outline-3">
<h3 id="figure-out-why-init-graphics-is-crashing-the-process-can-we-come-up-with-a-good-debugging-strategy-running-via-gdb"><span class="done DONE">DONE</span> Figure out why <code>init-graphics</code> is crashing the process, can we come up with a good debugging strategy (running via gdb)</h3>
<div class="outline-text-3">
</div>
</div>

<div id="outline-container-transmit-drawing-instructions-to-renderer-thread-in-some-form" class="outline-3">
<h3 id="transmit-drawing-instructions-to-renderer-thread-in-some-form"><span class="todo TODO">TODO</span> Transmit drawing instructions to renderer thread in some form</h3>
</div>
<div id="outline-container-get-the-basic-gfx-scm-example-working" class="outline-3">
<h3 id="get-the-basic-gfx-scm-example-working"><span class="todo TODO">TODO</span> Get the <code>basic-gfx.scm</code> example working</h3>
</div>
<div id="outline-container-render-the-completed-image-to-a-png-file" class="outline-3">
<h3 id="render-the-completed-image-to-a-png-file"><span class="todo TODO">TODO</span> Render the completed image to a .png file</h3>
<div class="outline-text-3">
<p>
<a href="https://stackoverflow.com/questions/34255820/save-sdl-texture-to-file">https://stackoverflow.com/questions/34255820/save-sdl-texture-to-file</a>
</p>
</div>
</div>
</div>

<div id="outline-container-notes" class="outline-2">
<h2 id="notes">Notes</h2>
<div class="outline-text-2">
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/guile/manual/html_node/Foreign-Function-Interface.html">https://www.gnu.org/software/guile/manual/html_node/Foreign-Function-Interface.html</a></li>
<li><a href="https://www.gnu.org/software/guile/manual/html_node/Foreign-Functions.html">https://www.gnu.org/software/guile/manual/html_node/Foreign-Functions.html</a></li>
<li><a href="https://www.gnu.org/software/guile/manual/html_node/Foreign-Structs.html">https://www.gnu.org/software/guile/manual/html_node/Foreign-Structs.html</a></li>
<li><a href="https://www.gnu.org/software/guile/manual/html_node/Void-Pointers-and-Byte-Access.html">https://www.gnu.org/software/guile/manual/html_node/Void-Pointers-and-Byte-Access.html</a></li>
<li><a href="https://willosborne.co.uk/coding/2019/11/16/iterators-and-for-loops-with-guile-scheme.html">https://willosborne.co.uk/coding/2019/11/16/iterators-and-for-loops-with-guile-scheme.html</a></li>
<li><a href="https://sourceforge.net/p/sdl2gfx/code/HEAD/tree/trunk/SDL2_gfxPrimitives.h">https://sourceforge.net/p/sdl2gfx/code/HEAD/tree/trunk/SDL2_gfxPrimitives.h</a></li>
<li><a href="https://www.ferzkopp.net/Software/SDL2_gfx/Docs/html/_s_d_l2__gfx_primitives_8h.html">https://www.ferzkopp.net/Software/SDL2_gfx/Docs/html/_s_d_l2__gfx_primitives_8h.html</a></li>
<li><a href="https://www.gnu.org/software/guile/manual/html_node/Coding-With-Keywords.html">https://www.gnu.org/software/guile/manual/html_node/Coding-With-Keywords.html</a></li>
</ul>

<p>
The commit for the code from this stream:
</p>

<p>
<a href="https://github.com/FluxHarmonic/flux-compose/commit/4adf5e16fc161f23cc9b95398f006ad6fb97c3c2">https://github.com/FluxHarmonic/flux-compose/commit/4adf5e16fc161f23cc9b95398f006ad6fb97c3c2</a>
</p>
</div>
</div>

<div id="outline-container-next-steps" class="outline-2">
<h2 id="next-steps">Next Steps</h2>
<div class="outline-text-2" id="text-next-steps">
</div>
<div id="outline-container-try-to-finish-instantiating-a-test-scene-in-c-use-gan-s-example" class="outline-3">
<h3 id="try-to-finish-instantiating-a-test-scene-in-c-use-gan-s-example"><span class="todo TODO">TODO</span> Try to finish instantiating a test scene in C (use Gan's example)</h3>
</div>
<div id="outline-container-figure-out-how-to-create-the-c-struct-representation-for-scene-objects-in-scheme" class="outline-3">
<h3 id="figure-out-how-to-create-the-c-struct-representation-for-scene-objects-in-scheme"><span class="todo TODO">TODO</span> Figure out how to create the C struct representation for scene objects in Scheme</h3>
</div>
<div id="outline-container-transmit-drawing-instructions-to-renderer-thread-in-some-form-sdl-event" class="outline-3">
<h3 id="transmit-drawing-instructions-to-renderer-thread-in-some-form-sdl-event"><span class="todo TODO">TODO</span> Transmit drawing instructions to renderer thread in some form (SDL event?)</h3>
</div>
<div id="outline-container-get-the-basic-gfx-scm-example-working" class="outline-3">
<h3 id="get-the-basic-gfx-scm-example-working"><span class="todo TODO">TODO</span> Get the <code>basic-gfx.scm</code> example working</h3>
</div>
<div id="outline-container-make-sure-that-we-can-re-eval-the-scheme-code-to-update-the-live-preview" class="outline-3">
<h3 id="make-sure-that-we-can-re-eval-the-scheme-code-to-update-the-live-preview"><span class="todo TODO">TODO</span> Make sure that we can re-eval the Scheme code to update the live preview</h3>
</div>
<div id="outline-container-render-the-completed-image-to-a-png-file" class="outline-3">
<h3 id="render-the-completed-image-to-a-png-file"><span class="todo TODO">TODO</span> Render the completed image to a .png file</h3>
</div>
</div>

    </section>
  </article>

    </main>

    
    
      <footer>&copy; 2021 Flux Harmonic</footer>
    

  </body>
</html>
